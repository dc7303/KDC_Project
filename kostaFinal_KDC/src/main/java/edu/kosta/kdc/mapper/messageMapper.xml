<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="messageMapper">
    
    <resultMap type="messageDTO" id="messageSelectMap">
      <id column="MESSAGE_PK" property="messageNum"/>
      <result column="MESSAGE_SENDER_ID" property="senderId"/>
      <result column="MESSAGE_RECEIVER_ID" property="receiverId"/>
      <result column="MESSAGE_TITLE" property="messageTitle"/>
      <result column="MESSAGE_CONTENTS" property="messageContents"/>
      <result column="MESSAGE_DATE" property="messageDate"/>
      <result column="MESSAGE_ISREAD" property="messageIsRead" typeHandler="edu.kosta.kdc.util.YesNoBooleanTypeHandler"/>
      <result column="MESSAGE_ISDELETE" property="messageIsDelete" typeHandler="edu.kosta.kdc.util.YesNoBooleanTypeHandler"/>
    </resultMap>
    
    <select id="adminMessageSelectAll" resultMap="messageSelectMap">
        select *
        from message
        where MESSAGE_RECEIVER_ID='admin' and MESSAGE_ISDELETE='FALSE'
    </select>

    <insert id="insertMessage" parameterType="messageDTO">
        insert into message
        values (MESSAGE_SEQ.NEXTVAL,#{senderId},#{receiverId},#{messageTitle},#{messageContents},sysdate,'FALSE','FALSE')
    </insert>
    
    <update id="deleteMessage" parameterType="int">
        update message
        set MESSAGE_ISDELETE='TRUE'
        where MESSAGE_PK=#{_parameter}
    </update>
</mapper>